:root{
  --bg:#0b1220; --fg:#e5e7eb; --task:#111827; --accent:#3b82f6; --win:#1f2937; --border:#374151; --glow:#8b5cf6;
  /* Animation tokens */
  --anim-fast: .14s;
  --anim-med: .22s;
  --anim-slow: .36s;
  --ease-out: cubic-bezier(.22,1,.36,1);
  --ease-in-out: cubic-bezier(.4,0,.2,1);
}
body.theme-light{ --bg:#f3f4f6; --fg:#0f172a; --task:#e5e7eb; --win:#ffffff; --border:#cbd5e1; }
html,body{height:100%;}
body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,Segoe UI,Arial,sans-serif;overflow:hidden}
.desktop{position:absolute;inset:0;background-position:center;background-size:cover;background-repeat:no-repeat;filter:saturate(1.05)}
.taskbar{position:absolute;left:50%;transform:translateX(-50%);bottom:12px;height:64px;background:rgba(17,24,39,.82);backdrop-filter:blur(24px) saturate(1.1);display:flex;align-items:center;padding:12px 18px;gap:14px;border:1px solid var(--border);border-radius:18px;box-shadow:0 18px 60px rgba(0,0,0,.45);width: min(72vw, 1100px);justify-content:space-between;z-index:10000}
body.theme-light .taskbar{ background: rgba(255,255,255,.9); box-shadow:0 18px 60px rgba(0,0,0,.12); }
.taskbar.crowded{width:min(86vw,1200px)}
.taskbar-left,.taskbar-right{display:flex;align-items:center;gap:10px}
.start-btn{width:46px;height:46px;border:1px solid var(--border);border-radius:12px;background:#1f2937;color:#fff;cursor:pointer;display:inline-flex;align-items:center;justify-content:center;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out), background var(--anim-med) var(--ease-in-out)}
.start-btn:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: scale(1.08); font-weight:600}
body.theme-light .start-btn{background:#ffffff;color:#0f172a}
.taskbar-windows{display:flex;gap:10px;overflow:visible;align-items:flex-end}
.taskbar.scrollable .taskbar-windows{overflow:auto;padding-bottom:4px}
/* During hover magnification, allow items to overflow container so they don't get clipped */
.taskbar-windows.dock-hover{overflow:visible !important}
.taskbar.scrollable .taskbar-windows::-webkit-scrollbar{height:8px}
.taskbar.scrollable .taskbar-windows::-webkit-scrollbar-thumb{background:rgba(255,255,255,.35);border-radius:8px}
.taskbar.scrollable .taskbar-windows::-webkit-scrollbar-track{background:transparent}

.dock-scroll-btn{border:0;background:#1f2937;color:#fff;border:1px solid var(--border);width:34px;height:34px;border-radius:10px;display:none;align-items:center;justify-content:center;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.dock-scroll-btn:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: scale(1.08)}
.taskbar.scrollable .dock-scroll-btn{display:inline-flex}
.task-item{display:flex;align-items:center;gap:0;background:#1f2937;border:1px solid var(--border);color:#fff;border-radius:12px;padding:6px;cursor:pointer;width:48px;height:48px;justify-content:center;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out); transform-origin: bottom center}
.task-item:hover{box-shadow:0 12px 30px rgba(139,92,246,.35), 0 0 0 1px rgba(139,92,246,.45) inset}
body.theme-light .task-item{background:#ffffff;color:#0f172a}
.task-item .task-icon{width:20px;height:20px;display:inline-flex;align-items:center;justify-content:center}
.task-item .task-icon .iconify{font-size:20px}
.task-item .task-icon img{width:20px;height:20px;object-fit:contain}
.task-item .task-title{display:none}

/* Dock magnification: scale hovered and push siblings */
.dock-hover .task-item{transition:transform var(--anim-fast) var(--ease-out)}
.dock-hover .task-item:hover{transform: translateY(-6px) scale(1.28)}
.dock-hover .task-item{will-change: transform}
.dock-hover .task-item:hover{z-index:2}
.spacer{display:none}
.clock{font-variant-numeric:tabular-nums; display:flex; flex-direction:column; align-items:flex-end; line-height:1.05}
.clock .time{font-weight:700}
.clock .date{opacity:.85; font-size:12px}
.start-menu{position:absolute;bottom:88px;width:760px;background:transparent;border:0;border-radius:16px;box-shadow:none;z-index:10001}
.start-menu.hidden{display:none}
.start-menu-header{padding:8px 10px;border-bottom:1px solid var(--border);display:none}
.start-tabs{display:flex;gap:8px}
.start-tab-btn{display:inline-flex;align-items:center;gap:6px;background:#374151;color:#e5e7eb;border:1px solid var(--border);border-radius:999px;padding:6px 10px;cursor:pointer}
.start-tab-btn.active{box-shadow:0 6px 16px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset}
body.theme-light .start-tab-btn{background:#ffffff;color:#0f172a}
.start-menu-grid{display:grid;grid-template-columns:3fr 1fr;gap:12px;background:transparent}
.start-menu .pane{min-height:260px;max-height:480px;overflow:auto;background:rgba(17,24,39,.78);backdrop-filter:blur(16px) saturate(1.05);border:1px solid var(--border);border-radius:12px}
body.theme-light .start-menu .pane{ background: rgba(255,255,255,.92); }
.start-menu .pane:not(:first-child){border-left:0}
.start-menu .pane-title{padding:12px 14px;opacity:.95;font-weight:800;border-bottom:1px solid var(--border)}
.start-menu-apps{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:12px;padding:14px}
.start-menu-list{display:flex;flex-direction:column;gap:6px;padding:8px 6px}
.start-menu-list{align-items:flex-start}
/* Prevent horizontal scrollbar on hover scale */
#allapps-container{overflow-x:hidden}
.start-app{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:8px;background:#1f2937;color:#fff;border:1px solid var(--border);border-radius:12px;padding:16px 12px;cursor:pointer;text-align:center;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.start-app:hover{box-shadow:0 12px 28px rgba(139,92,246,.35), 0 0 0 1px rgba(139,92,246,.45) inset; transform: translateY(-1px) scale(1.25); font-weight:700}
.start-app:hover .app-title{font-weight:600}
body.theme-light .start-app{background:#ffffff;color:#0f172a}
.start-app .app-icon{width:44px;height:44px;display:inline-flex;align-items:center;justify-content:center}
.start-app .app-icon .iconify{font-size:36px}
.start-app .app-icon img{width:36px;height:36px;object-fit:contain;border-radius:8px}
.start-app .app-icon .app-img{width:36px;height:36px;border-radius:8px}
.start-app .app-title{max-width:100%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:13px}

/* Start list items look like rows */
.start-menu-list .start-app{display:inline-flex;flex-direction:row;justify-content:flex-start;gap:10px;padding:12px 20px;border-radius:10px;background:transparent;border-color:transparent;transform-origin:left center;max-width:260px}
.start-menu-list .start-app .app-icon{width:24px;height:24px}
.start-menu-list .start-app .app-icon .iconify{font-size:20px}
.start-menu-list .start-app .app-icon img{width:20px;height:20px}
.start-menu-list .start-app .app-title{font-size:14px}
.start-menu-list .start-app:hover{background:rgba(255,255,255,.06); border-color:var(--border)}
body.theme-light .start-menu-list .start-app:hover{ background: rgba(0,0,0,.05); }

/* Taskbar pins */
.taskbar-pins{display:flex;gap:6px;margin-left:6px}
.taskbar-pins .pin{width:34px;height:34px;border:1px solid var(--border);border-radius:10px;background:#1f2937;color:#fff;display:inline-flex;align-items:center;justify-content:center;cursor:pointer;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.taskbar-pins .pin:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: translateY(-2px) scale(1.18)}

/* Start menu context menu */
.start-ctx{position:absolute;z-index:10002;min-width:190px;padding:6px;display:flex;flex-direction:column;gap:4px}
.start-ctx.hidden{display:none}
.start-ctx .menu-btn{display:flex;gap:8px;align-items:center;width:100%;text-align:left;padding:8px;border-radius:8px;border:1px solid var(--border);background:#374151;color:#e5e7eb;cursor:pointer;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.start-ctx .menu-btn:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset}
.start-ctx .menu-btn.danger{background:#4b1d1d;border-color:#ef4444}
/* Mobile Start menu */
body.is-mobile .start-menu{width:calc(100vw - 16px); left:50% !important; transform:translateX(-50%); bottom:76px; max-height:50vh; overflow:auto}
body.is-mobile .start-menu-header{display:none}
body.is-mobile .start-menu-grid{display:block}
body.is-mobile .start-menu .pane{max-height:unset; overflow:visible}
.window{position:absolute;top:80px;left:80px;width:640px;height:420px;background:rgba(31,41,55,.76);backdrop-filter:blur(20px) saturate(1.05);border:1px solid var(--border);border-radius:14px;display:flex;flex-direction:column;box-shadow:0 16px 44px rgba(0,0,0,.50)}
body.theme-light .window{ background: rgba(255,255,255,.98); box-shadow:0 16px 40px rgba(0,0,0,.12); }
.window.active-window{box-shadow:0 28px 80px rgba(0,0,0,.65), 0 0 0 1px rgba(139,92,246,.35) inset}
.titlebar{height:38px;display:flex;align-items:center;justify-content:space-between;padding:0 8px;background:rgba(31,41,55,.76);backdrop-filter:blur(20px) saturate(1.05);border-bottom:1px solid var(--border);border-radius:14px 14px 0 0;user-select:none;cursor:move;touch-action:none}
body.theme-light .titlebar{ background: rgba(255,255,255,.96); }
.titlebar .left-controls{display:flex;align-items:center;gap:6px}
.titlebar .title-center{position:absolute;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:8px;pointer-events:none}
.titlebar .title-center .title-icon{width:20px;height:20px;display:inline-flex;align-items:center;justify-content:center}
.titlebar .title-center .title-icon img{width:20px;height:20px;border-radius:5px}
.titlebar .title-center .title-icon .iconify{font-size:20px}
.titlebar .title-center .title-icon svg{width:20px;height:20px}
.titlebar .title-center .title-text{font-weight:600}
.titlebar, .window{will-change: transform, top, left, width, height}
.titlebar .controls button,
.titlebar .left-controls button{width:30px;height:24px;margin-left:6px;border:1px solid var(--border);border-radius:6px;background:#374151;color:#e5e7eb;cursor:pointer;transition:box-shadow var(--anim-med) var(--ease-in-out), background var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.titlebar .controls button:hover,
.titlebar .left-controls button:hover{box-shadow:0 6px 16px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: scale(1.1)}
body.theme-light .titlebar .controls button{background:#e5e7eb;color:#0f172a}
/* Disabled back button state */
.titlebar .left-controls .btn-back[disabled]{
  opacity:.45;
  cursor:not-allowed;
  filter:grayscale(0.3);
}
body.theme-light .titlebar .left-controls button{background:#e5e7eb;color:#0f172a}
.titlebar .left-controls .btn-pane.pwa-hidden{display:none}
.content{flex:1;background:rgba(0,0,0,.12);border-radius:0 0 14px 14px;overflow:hidden;position:relative}
body.theme-light .content{ background: rgba(0,0,0,.02); }
.window.glow-enabled{position:absolute}
.window.glow-enabled::before{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;z-index:2;background:radial-gradient(270px circle at var(--mx,-1000px) var(--my,-1000px), color-mix(in oklab, var(--glow) 16%, transparent), transparent 66%);opacity:var(--gopa,.0);transition:opacity .28s ease}
.resizer{position:absolute;background:transparent;touch-action:none}
.resizer-e{top:0;bottom:0;right:-3px;width:6px;cursor:ew-resize}
.resizer-w{top:0;bottom:0;left:-3px;width:6px;cursor:ew-resize}
.resizer-n{top:-3px;left:0;right:0;height:6px;cursor:ns-resize}
.resizer-s{bottom:-3px;left:0;right:0;height:6px;cursor:ns-resize}
.resizer-se{right:-2px;bottom:-2px;width:12px;height:12px;cursor:nwse-resize;background:linear-gradient(135deg, transparent 50%, rgba(255,255,255,.35) 50%)}
.resizer-sw{left:-2px;bottom:-2px;width:12px;height:12px;cursor:nesw-resize;background:linear-gradient(225deg, transparent 50%, rgba(255,255,255,.35) 50%)}
.resizer-ne{right:-2px;top:-2px;width:12px;height:12px;cursor:nesw-resize;background:linear-gradient(45deg, transparent 50%, rgba(255,255,255,.35) 50%)}
.resizer-nw{left:-2px;top:-2px;width:12px;height:12px;cursor:nwse-resize;background:linear-gradient(315deg, transparent 50%, rgba(255,255,255,.35) 50%)}

iframe.app-frame{width:100%;height:100%;border:0}
.content > .app-host{width:100%;height:100%}

.calendar{position:absolute;right:8px;bottom:84px;width:260px;background:rgba(17,24,39,.82);backdrop-filter:blur(22px);border:1px solid var(--border);border-radius:12px;box-shadow:0 14px 40px rgba(0,0,0,.55);color:#fff;padding:10px;z-index:10001}
body.theme-light .calendar{ background:#ffffff; color:#0f172a; box-shadow:0 14px 40px rgba(0,0,0,.12); }
.calendar.hidden{display:none}
.calendar table{width:100%;border-collapse:collapse;text-align:center}
.calendar th,.calendar td{padding:6px}
.calendar .header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.calendar button{background:#374151;color:#fff;border:0;border-radius:6px;padding:4px 8px}

/* Blur toggle strength */
body.blur-on .taskbar, body.blur-on .start-menu, body.blur-on .window .titlebar { backdrop-filter: blur(28px) saturate(1.25); }

/* Apps menu (All apps / Close all) */
.apps-menu{position:absolute;bottom:110px;width:640px;min-height:340px;max-height:520px;background:rgba(17,24,39,.75);backdrop-filter:blur(18px);border:1px solid var(--border);border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.5);color:#fff;padding:14px;z-index:10001;overflow:auto}
body.theme-light .apps-menu{ background:#ffffff; color:#0f172a; box-shadow:0 10px 30px rgba(0,0,0,.12); }
.apps-menu.hidden{display:none}
.apps-menu .apps-menu-bar{display:flex;justify-content:space-between;align-items:center;margin:-6px -6px 12px -6px;padding:0 6px}
.apps-menu .apps-menu-bar .icon-btn{display:flex;align-items:center;gap:6px;background:#374151;color:#e5e7eb;border:1px solid var(--border);border-radius:8px;padding:8px 12px;cursor:pointer;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.apps-menu .apps-menu-bar .icon-btn:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: scale(1.08); font-weight:600}
body.theme-light .apps-menu .apps-menu-bar .icon-btn{background:#ffffff;color:#0f172a}
.apps-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(140px,1fr));gap:14px}
.apps-grid .start-app{position:relative;background:#1f2937;border:1px solid var(--border);border-radius:14px;padding:20px 14px}
.apps-grid .start-app .app-icon{width:56px;height:56px}
.apps-grid .start-app .app-icon .iconify{font-size:44px}
.apps-grid .start-app .app-icon .app-img{width:44px;height:44px;border-radius:10px}
.apps-grid .start-app .app-title{font-size:14px}
/* Close button on running app tile */
.apps-grid .start-app .app-close{position:absolute;top:8px;right:8px;width:24px;height:24px;border:1px solid var(--border);border-radius:6px;background:#374151;color:#e5e7eb;display:none;align-items:center;justify-content:center;cursor:pointer;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.apps-grid .start-app .app-close:hover{box-shadow:0 6px 16px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: scale(1.06)}
body.theme-light .apps-grid .start-app .app-close{background:#ffffff;color:#0f172a}
.apps-grid .start-app:hover .app-close{display:inline-flex}
body.is-mobile .apps-grid .start-app .app-close{display:inline-flex}
/* Mobile Apps menu */
body.is-mobile .apps-menu{width:calc(100vw - 16px); left:50% !important; transform:translateX(-50%); bottom:84px; max-height:60vh}
body.is-mobile .apps-grid{grid-template-columns:repeat(2, minmax(0,1fr))}

/* User menu */
.user-menu{position:absolute;bottom:110px;width:300px;min-width:300px;background:rgba(17,24,39,.75);backdrop-filter:blur(18px);border:1px solid var(--border);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.5);padding:8px;z-index:10001}
body.theme-light .user-menu{ background:#ffffff; box-shadow:0 10px 30px rgba(0,0,0,.12); }
.user-menu.hidden{display:none}
/* Mobile User menu */
body.is-mobile .user-menu{left:50% !important; transform:translateX(-50%); width:calc(100vw - 16px); min-width:auto; bottom:84px}
body.is-mobile .user-card{ min-width:auto }

/* User card */
.user-card{display:flex;align-items:center;gap:10px;padding:8px 6px;border-bottom:1px solid var(--border);margin-bottom:6px;min-width:280px}
.user-card{padding:12px 10px;margin-bottom:10px}
.user-card .avatar{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#111827;color:#e5e7eb;font-weight:600;border:1px solid var(--border)}
.user-card .avatar{width:56px;height:56px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#111827;color:#e5e7eb;font-weight:700;border:1px solid var(--border);overflow:hidden}
.user-card .avatar img{width:100%;height:100%;object-fit:cover}
.user-card .info .name{font-weight:600}
.user-card .info .phone{opacity:.8;font-size:12px}
.user-actions{display:flex;gap:8px;padding:4px}
.user-actions{padding:8px}
.user-actions .icon-btn{display:flex;align-items:center;gap:6px;background:#374151;color:#e5e7eb;border:1px solid var(--border);border-radius:8px;padding:8px 12px;cursor:pointer;transition:box-shadow var(--anim-med) var(--ease-in-out), transform var(--anim-fast) var(--ease-out)}
.user-actions .icon-btn:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset; transform: scale(1.08); font-weight:600}
body.theme-light .user-actions .icon-btn{background:#ffffff;color:#0f172a}
.user-actions .icon-btn .iconify{filter:grayscale(1);opacity:.9}

/* Pills and pill buttons */
.pill{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;background:#374151;border:1px solid var(--border);font-size:12px}
.pill-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;border:1px solid var(--border);cursor:pointer;transition:transform var(--anim-fast) var(--ease-out), box-shadow var(--anim-med) var(--ease-in-out);background:#374151;color:#e5e7eb}
.pill-btn:hover{transform:translateY(-1px);box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset}
.pill-btn .iconify{font-size:16px}
.pill-ok{background:#0b3d22;border-color:#178a4a;color:#d1fae5}
.pill-warn{background:#3a2e0b;border-color:#b7791f;color:#fef3c7}
.pill-danger{background:#4b1d1d;border-color:#ef4444;color:#fee2e2}
.pill-btn .label{font-weight:600}
/* Syncing spinner animation on icon */
@keyframes spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }
.pill-spinning .iconify{animation: spin 1s linear infinite}

/* Network pill color variants */
#user-net.danger{background:#4b1d1d;border-color:#ef4444;color:#fee2e2}
#user-net{background:#0b3d22;border-color:#178a4a;color:#d1fae5}

/* Taskbar avatar image */
#user-button .tb-avatar{width:28px;height:28px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;background:#111827;color:#e5e7eb;border:1px solid var(--border);font-weight:700}
#user-button .tb-avatar-img{width:28px;height:28px;border-radius:50%;object-fit:cover;border:1px solid var(--border)}

/* Global scrollbar track hidden; keep only thumbs */
*::-webkit-scrollbar-track{background:transparent}
*::-webkit-scrollbar{width:10px;height:10px}
*::-webkit-scrollbar-thumb{background:rgba(255,255,255,.35);border-radius:10px}
/* Firefox */
*{scrollbar-width:thin; scrollbar-color: rgba(255,255,255,.35) transparent}

/* Overlay used during drag/resize to prevent iframe capture */
.interaction-shield{position:fixed;inset:0;background:transparent;z-index:9998}

/* Welcome splash */
.splash{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:radial-gradient(ellipse at 50% 40%, rgba(0,0,0,.35), rgba(0,0,0,.65));backdrop-filter:blur(8px);z-index:11000;opacity:1;transition:opacity var(--anim-slow) var(--ease-in-out)}
.splash.hidden{opacity:0;pointer-events:none}
.splash-card{min-width:320px;max-width:520px;background:rgba(17,24,39,.88);border:1px solid var(--border);border-radius:16px;box-shadow:0 30px 90px rgba(0,0,0,.55);padding:22px}
.splash-title{font-size:22px;font-weight:800;margin-bottom:6px}
.splash-sub{opacity:.9;margin-bottom:12px}
.splash-progress{height:8px;background:rgba(255,255,255,.12);border-radius:999px;overflow:hidden;border:1px solid var(--border)}
.splash-bar{height:100%;background:linear-gradient(90deg, var(--glow), var(--accent));width:0%;transition:width .4s var(--ease-in-out)}

/* Dock hover popup */
.dock-pop{position:absolute;pointer-events:none;z-index:10002;display:flex;flex-direction:column;align-items:center;gap:8px;transform:translate(-50%, -16px) scale(.9);opacity:0;transition:opacity var(--anim-fast) var(--ease-out), transform var(--anim-fast) var(--ease-out)}
.dock-pop .dock-pop-icon{width:72px;height:72px;border-radius:16px;background:#1f2937;border:1px solid var(--border);display:flex;align-items:center;justify-content:center;box-shadow:0 16px 40px rgba(0,0,0,.45)}
.dock-pop .dock-pop-icon img{width:56px;height:56px;border-radius:12px}
.dock-pop .dock-pop-title{background:rgba(17,24,39,.9);backdrop-filter:blur(10px);border:1px solid var(--border);border-radius:10px;padding:6px 10px;font-weight:600;color:#fff;white-space:nowrap}
.dock-pop.show{opacity:1;transform:translate(-50%, -24px) scale(1)}
.dock-pop.hidden{display:none}

/* Search menu above dock */
.search-menu{position:absolute;bottom:110px;width:640px;max-height:50vh;overflow:hidden;background:rgba(17,24,39,.78);backdrop-filter:blur(16px);border:1px solid var(--border);border-radius:12px;box-shadow:0 16px 40px rgba(0,0,0,.5);padding:10px;z-index:10001;opacity:0;transform:translateY(8px);transition:opacity var(--anim-med) var(--ease-in-out), transform var(--anim-med) var(--ease-in-out);display:flex;flex-direction:column}
.search-menu.hidden{display:none}
.search-menu.show{opacity:1;transform:translateY(0)}
.search-bar{display:flex;align-items:center;gap:8px;padding:6px 8px;border:1px solid var(--border);border-radius:10px;background:transparent;order:2;margin-top:10px}
.search-bar .iconify{opacity:.9}
.search-bar .input{background:transparent !important; border:0 !important; outline:none; color:var(--fg)}
.search-bar .input::placeholder{color:rgba(255,255,255,.7)}
.search-results{margin-top:0;display:flex;flex-direction:column;gap:6px;max-height:40vh;overflow:auto;position:relative;z-index:1;order:1;flex:1}
.search-results .result{display:flex;gap:8px;align-items:center;padding:8px;border-radius:8px;border:1px solid var(--border);background:#1f2937}
.search-results .result:hover{box-shadow:0 8px 20px rgba(139,92,246,.25), 0 0 0 1px rgba(139,92,246,.35) inset}

/* Menu animations */
.start-menu,.apps-menu,.user-menu{opacity:0;transform:translateY(8px);transition:opacity var(--anim-med) var(--ease-in-out), transform var(--anim-med) var(--ease-in-out)}
.start-menu.hidden,.apps-menu.hidden,.user-menu.hidden{display:none}
.start-menu:not(.hidden),.apps-menu:not(.hidden),.user-menu:not(.hidden){opacity:1;transform:translateY(0)}

/* Mobile layout overrides */
body.is-mobile .desktop{inset:0}
body.is-mobile .taskbar{width:calc(100vw - 16px); left:50%; transform:translateX(-50%); gap:10px; padding:10px 12px; bottom:12px}
body.is-mobile .taskbar-left{gap:8px}
body.is-mobile .taskbar-right{gap:8px}
body.is-mobile #taskbar-windows{display:none}
body.is-mobile #dock-left, body.is-mobile #dock-right{display:none}
body.is-mobile #clock{display:none}
body.is-mobile .dock-pop{display:none}
body.is-mobile .start-btn{width:42px;height:42px}
body.is-mobile #user-button .tb-avatar{width:28px;height:28px;border-radius:50%;display:inline-flex;align-items:center;justify-content:center;background:#111827;color:#e5e7eb;border:1px solid var(--border);font-weight:600}

/* Windows: full-screen single view on mobile */
body.is-mobile .window{left:0 !important; top:0 !important; width:100% !important; height:calc(100% - 80px) !important; border-radius:0; box-shadow:none}
body.is-mobile .titlebar{cursor:default}
body.is-mobile .titlebar .controls .btn-min,
body.is-mobile .titlebar .controls .btn-max{display:none}
body.is-mobile .resizer{display:none}

/* Subtle window enter animation */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(8px) scale(.98); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}
.window{ animation: fadeInUp var(--anim-med) var(--ease-out); }

@keyframes fadeOutDown {
  from { opacity: 1; transform: translateY(0) scale(1); }
  to { opacity: 0; transform: translateY(8px) scale(.98); }
}
.window.minimizing{ animation: fadeOutDown var(--anim-med) var(--ease-in-out) forwards; }
.window.restoring{ animation: fadeInUp var(--anim-med) var(--ease-out); }

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  *, *::before, *::after{
    animation-duration: 0.001s !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.001s !important;
  }
}

/* Light theme extras: splash and dock title */
body.theme-light .splash{ background: radial-gradient(ellipse at 50% 40%, rgba(255,255,255,.6), rgba(255,255,255,.9)); }
body.theme-light .splash-card{ background:#ffffff; box-shadow:0 30px 90px rgba(0,0,0,.12); }
body.theme-light .dock-pop .dock-pop-title{ background:#ffffff; color:#0f172a; }
